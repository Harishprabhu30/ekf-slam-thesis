ekf_filter_node:
  ros__parameters:
    use_sim_time: true

    # EKF update target: match your sensor rate (~18 Hz). 20 is a good stable choice.
    frequency: 20.0
    sensor_timeout: 0.2
    two_d_mode: true

    # TF / Frames (LOCKED)
    odom_frame: odom
    base_link_frame: chassis_link
    world_frame: odom

    publish_tf: true
    publish_acceleration: false
    reset_on_time_jump: true

    # -------------------------
    # ODOMETRY INPUT (/odom)
    # -------------------------
    odom0: /odom
    odom0_queue_size: 10
    odom0_nodelay: true

    # Fuse: x, y, vx from wheel odom.
    # Do NOT fuse yaw from wheel odom (avoid double yaw integration).
    # State order:
    # [x, y, z, roll, pitch, yaw, vx, vy, vz, vroll, vpitch, vyaw, ax, ay, az]
    odom0_config: [
      true,  true,  false,
      false, false, false,
      true,  false, false,
      false, false, false,
      false, false, false
    ]

    odom0_differential: false
    odom0_relative: false

    # -------------------------
    # IMU INPUT (/imu)  (validated stream)
    # -------------------------
    imu0: /imu
    imu0_queue_size: 20
    imu0_nodelay: true

    # Fuse only yaw-rate (vyaw). Ignore orientation and accel.
    imu0_config: [
      false, false, false,
      false, false, false,
      false, false, false,
      false, false, true,
      false, false, false
    ]

    imu0_differential: false
    imu0_relative: false
    imu0_remove_gravitational_acceleration: false
